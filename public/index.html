<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>GPTs Help – Learn Math with AI</title>
  <style>
    :root {
      --brand:#6f42c1;
      --accent:#ffc107;
      --bg:#f8f9fa;
      --text:#212529;
      --muted:#6c757d;
      --panel:#fff;
      --border:#eee;
      --shadow:0 16px 36px rgba(0,0,0,.08);
      --error:#dc3545;
      --ok:#198754;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,sans-serif;color:var(--text);background:var(--bg)}
    a{color:var(--brand);text-decoration:none}
    header{background:#fff;border-bottom:1px solid #eee}
    .nav{max-width:1200px;margin:0 auto;padding:1rem 2rem;display:flex;align-items:center;justify-content:space-between}
    .brand{font-weight:800;letter-spacing:.2px}
    .nav-right{display:flex;gap:.5rem;align-items:center}
    .btn-nav{border:1px solid var(--border);background:#fff;color:var(--brand);padding:.55rem .9rem;border-radius:10px;cursor:pointer;font-weight:600}
    .btn-nav.primary{background:var(--brand);color:#fff;border-color:transparent}
    .hero{background:linear-gradient(135deg,var(--brand),#9c6fff);color:#fff;text-align:center;padding:5rem 2rem}
    .hero h1{font-size:clamp(2rem,4vw,3rem);margin-bottom:1rem}
    .hero p{font-size:1.1rem;max-width:720px;margin:0 auto 0;opacity:.98}
    .container{max-width:1200px;margin:0 auto;padding:2rem}
    h2{margin:.5rem 0}
    .features{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:1.5rem;margin-top:2rem}
    .card{background:#fff;border:1px solid #eee;border-radius:12px;padding:1.5rem;box-shadow:0 4px 10px rgba(0,0,0,.05)}
    .demo{margin-top:2rem;display:grid;grid-template-columns:1.2fr 1fr;gap:1.5rem}
    @media(max-width:960px){.demo{grid-template-columns:1fr}}
    .demo-left,.demo-right{background:#fff;border:1px solid #eee;border-radius:14px;padding:1.25rem;box-shadow:var(--shadow)}
    .drop{border:2px dashed #ddd;border-radius:12px;padding:1.25rem;text-align:center;color:#555}
    .drop.drag{border-color:#c5b3f7;background:#faf6ff}
    .drop input{display:none}
    .small{color:var(--muted);font-size:.9rem}
    .demo-actions{display:flex;gap:.6rem;justify-content:center;margin-top:.75rem}
    .btn{padding:.85rem 1.2rem;font-weight:700;border:none;border-radius:10px;cursor:pointer}
    .btn-primary{background:var(--accent);color:#000}
    .btn-secondary{background:#fff;color:var(--brand);border:1px solid var(--border)}
    .preview{margin-top:1rem;display:flex;gap:1rem;flex-wrap:wrap;justify-content:center}
    .preview img{max-width:220px;border-radius:10px;border:1px solid #eee}
    .result{background:#0f1117;color:#e7eaf1;border-radius:12px;padding:1rem;border:1px solid #222;margin-top:1rem;min-height:120px;white-space:pre-wrap}
    footer{text-align:center;padding:2rem;color:var(--muted);margin-top:3rem;border-top:1px solid #eee}
    .overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.45);z-index:1000}
    .overlay.open{display:flex}
    .modal{width:min(520px,92vw);background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:18px;box-shadow:var(--shadow)}
    .close-x{border:0;background:transparent;color:#999;font-size:20px;cursor:pointer;float:right}
    .row{display:flex;gap:.6rem}
  </style>
</head>
<body>
<header>
  <div class="nav">
    <div class="brand">GPTs Help</div>
    <div class="nav-right">
      <button id="openChatBtn" class="btn-nav" style="display:none" onclick="goToChat()">Open Chat</button>
      <button id="loginBtn" class="btn-nav">Log in</button>
      <button id="signupBtn" class="btn-nav primary">Sign up for free</button>
    </div>
  </div>
</header>

<section class="hero">
  <h1>Snap → Solve. Master Math with AI.</h1>
  <p>Upload a math problem and get a step-by-step solution. Try it free — then unlock unlimited photo solves.</p>
</section>

<!-- Try Photo Solve -->
<section class="container">
  <h2>Try Photo Solve</h2>
  <div class="demo">
    <div class="demo-left">
      <div id="drop" class="drop">
        <strong>Drag & drop a math photo</strong><br/>
        <span class="small">or</span><br/>
        <button id="pickBtn" class="btn btn-secondary" type="button">Choose an image</button>
        <input id="fileInput" type="file" accept="image/png,image/jpeg,image/jpg,image/webp"/>
        <div class="small" style="margin-top:.6rem;">Free demo: <strong>2 photo solves</strong>. Sign up for unlimited.</div>
      </div>
      <div id="preview" class="preview"></div>
      <div id="demoActions" class="demo-actions" style="display:none;">
        <button id="solveBtn" class="btn btn-primary">Solve Now</button>
        <button id="clearBtn" class="btn">Clear</button>
      </div>
    </div>
    <div class="demo-right">
      <div class="small" style="margin-bottom:.5rem;">Result</div>
      <div id="result" class="result">Upload a math question to see the step-by-step solution here.</div>
    </div>
  </div>
</section>

<section class="container">
  <h2>Why Choose GPTs Help?</h2>
  <div class="features">
    <div class="card"><h3>Step-by-Step Solutions</h3><p>Clear reasoning, multiple methods, and clean final answers.</p></div>
    <div class="card"><h3>Exam-Ready Practice</h3><p>Adaptive practice with instant feedback and hints.</p></div>
    <div class="card"><h3>LaTeX-quality Output</h3><p>Readable math formatting for neat notes and submissions.</p></div>
    <div class="card"><h3>Secure & Fast</h3><p>Trusted Paystack payments. Your data stays private.</p></div>
  </div>
</section>

<section class="container" id="pricing">
  <h2>Choose Your Plan</h2>
  <div class="features">
    <div class="card"><h3>Free Plan</h3><p>₂ photo solves • Basic step-by-step answers</p></div>
    <div class="card"><h3>Plus Monthly</h3><p>₵99/mo • Unlimited photo solves • Priority processing</p></div>
    <div class="card"><h3>Pro Annual</h3><p>₵790/yr • Unlimited solves • Save 34%</p></div>
  </div>
</section>

<footer>
  &copy; <span id="year"></span> GPTs Help. All rights reserved.
</footer>

<!-- Upgrade Modal -->
<div class="overlay" id="upgradeOverlay" aria-hidden="true">
  <div class="modal">
    <button class="close-x" id="upgradeClose">×</button>
    <h3>Free Demo Limit Reached</h3>
    <p>Sign up or upgrade to continue solving unlimited problems.</p>
    <div class="row" style="margin-top:.5rem">
      <button class="btn btn-secondary" id="signupNowBtn">Sign up</button>
      <button class="btn btn-primary" id="goProBtn">Upgrade Now</button>
    </div>
  </div>
</div>

<script>
const drop = document.getElementById("drop");
const pickBtn = document.getElementById("pickBtn");
const fileInput = document.getElementById("fileInput");
const preview = document.getElementById("preview");
const solveBtn = document.getElementById("solveBtn");
const clearBtn = document.getElementById("clearBtn");
const demoActions = document.getElementById("demoActions");
const resultEl = document.getElementById("result");
const upgradeOverlay = document.getElementById("upgradeOverlay");
const upgradeClose = document.getElementById("upgradeClose");
const signupNowBtn = document.getElementById("signupNowBtn");
const goProBtn = document.getElementById("goProBtn");

let selectedFile = null;
function openUpgrade(){upgradeOverlay.classList.add("open");}
function closeUpgrade(){upgradeOverlay.classList.remove("open");}
upgradeClose.onclick=closeUpgrade;
signupNowBtn.onclick=()=>location.href="/index.html#signup";
goProBtn.onclick=()=>location.href="#pricing";

['dragenter','dragover'].forEach(evt=>drop.addEventListener(evt,e=>{e.preventDefault();drop.classList.add('drag');}));
['dragleave','drop'].forEach(evt=>drop.addEventListener(evt,e=>{e.preventDefault();drop.classList.remove('drag');}));
drop.addEventListener('drop',e=>{const f=e.dataTransfer.files?.[0];if(f)handlePickedFile(f);});
pickBtn.addEventListener('click',()=>fileInput.click());
fileInput.addEventListener('change',()=>{const f=fileInput.files?.[0];if(f)handlePickedFile(f);});
function handlePickedFile(file){
  if(!['image/png','image/jpeg','image/jpg','image/webp'].includes(file.type)){alert('Choose a valid image.');return;}
  if(file.size>6*1024*1024){alert('Max size 6MB');return;}
  selectedFile=file;preview.innerHTML='';const url=URL.createObjectURL(file);
  const img=new Image();img.onload=()=>URL.revokeObjectURL(url);img.src=url;preview.appendChild(img);
  demoActions.style.display='flex';resultEl.textContent='Ready. Click “Solve Now”.';
}

async function solveFromHome(file){
  resultEl.textContent='⏳ Solving...';
  solveBtn.disabled=true;
  try{
    const me=await fetch('/api/me',{credentials:'include'}).then(r=>r.json()).catch(()=>({}));
    const fd=new FormData();fd.append('image',file);
    const endpoint=(me?.status==='ok'&&me.user?.email)?'/api/photo-solve':'/api/photo-solve-demo';
    const r=await fetch(endpoint,{method:'POST',credentials:'include',body:fd});
    const j=await r.json();
    if(r.status===403||j.error==='demo_limit_reached'){openUpgrade();resultEl.textContent='Free demo limit reached. Please sign up.';return;}
    resultEl.textContent=j.response||'No response.';
  }catch{resultEl.textContent='Error. Try again.';}
  finally{solveBtn.disabled=false;}
}
solveBtn.onclick=()=>{if(!selectedFile){alert('Pick an image first.');return;}solveFromHome(selectedFile);}
clearBtn.onclick=()=>{selectedFile=null;preview.innerHTML='';demoActions.style.display='none';resultEl.textContent='Upload a math question to see the step-by-step solution here.';}
document.getElementById("year").textContent=new Date().getFullYear();
function goToChat(){location.assign("/chat.html");}
</script>
</body>
</html>